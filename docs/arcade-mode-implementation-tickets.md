# 花札アーケードモード 実装チケット分割案 v0.1

本資料は `docs/arcade-mode-game-design.md` を実装可能な単位に分解したチケット案。

---

## Epic A: モード基盤と遷移

### A-1. モード選択導線
**目的**: クラシックとアーケードを分離して選べるようにする。  
**受け入れ条件**:
- タイトル画面から2モードを選択可能
- クラシックは既存体験へ遷移
- アーケードは新規フローへ遷移

### A-2. アーケード固定ルール適用
**目的**: アーケードではローカルルール編集不可にする。  
**受け入れ条件**:
- アーケード中はルール編集UIを非表示または閲覧専用
- 対局開始時に固定ルールが必ず適用される

---

## Epic B: マップ・隣接・領土状態

### B-1. 県マップデータ定義
**目的**: 県ノード、隣接関係、難易度帯、支配者IDをデータ化。  
**受け入れ条件**:
- 全県ノードを持つマスターデータがある
- 隣接関係をプログラムが参照できる
- 初期支配状態（島根のみ自軍）を定義

### B-2. 隣接県のみ挑戦可能ロジック
**目的**: 地理制約を実装。  
**受け入れ条件**:
- プレーヤー領地に隣接する県だけ侵攻可能
- 非隣接県は選択不可

### B-3. 領土状態管理
**目的**: 県ステータスを管理（自軍/敵軍/占領中）。  
**受け入れ条件**:
- 県ごとに現在状態が保存される
- 侵攻勝利で自軍化、逆侵攻成功で敵占領化

---

## Epic C: 侵攻戦（6月/12月）

### C-1. 侵攻前ルール選択UI
**目的**: 6月戦/12月戦を選べる。  
**受け入れ条件**:
- 侵攻開始前に2択UIを表示
- 選択結果が対戦設定に反映

### C-2. 一本勝負の侵攻フロー
**目的**: 1県1勝負で決着。  
**受け入れ条件**:
- 勝敗で県の帰属が更新される
- リザルト画面に次アクション導線がある

### C-3. 報酬倍率実装
**目的**: 12月戦2.5倍を反映。  
**受け入れ条件**:
- 6月戦 = x1.0
- 12月戦 = x2.5
- 報酬計算ログが検証可能

---

## Epic D: 難易度分布・敵生成

### D-1. 難易度分布関数
**目的**: ボス圏ほど難しい地理分布を作る。  
**受け入れ条件**:
- 島根近辺が低難易度
- 東京/大阪圏が高難易度
- 中間域に段階差がある

### D-2. 非表示難易度UI方針
**目的**: プレーヤーに直接数値を見せない。  
**受け入れ条件**:
- 難易度値は内部計算のみ
- 表示は演出テキスト/アイコン中心

### D-3. 部下敵の難易度上限
**目的**: 奪還戦で詰みを防ぐ。  
**受け入れ条件**:
- 部下強度はプレーヤー対等以下に制限
- 奪還不能の連続発生を防ぐテストを用意

---

## Epic E: 成長・報酬・経済

### E-1. 恒久成長データモデル
**目的**: 周回で強化が持ち越される仕組みを実装。  
**受け入れ条件**:
- プレーヤー成長情報がセーブされる
- 周回開始後も成長値が反映される

### E-2. 固定スキルシステム
**目的**: 恒久装備スキルを導入。  
**受け入れ条件**:
- 所持/装備/適用が可能
- 敵撃破ドロップ導線がある

### E-3. アイテムスキルシステム
**目的**: 消費型アイテムを導入。  
**受け入れ条件**:
- 所持数上限は実質無制限
- 1ターン1回使用制限が適用
- 戦闘中に使用ログが残る

---

## Epic F: 仲間化・練習試合

### F-1. 仲間化フラグ
**目的**: 勝利済み偉人を仲間名鑑に追加。  
**受け入れ条件**:
- 初回撃破で仲間化
- 名鑑/選択UIに表示

### F-2. 練習試合モード
**目的**: 仲間相手に反復対戦可能にする。  
**受け入れ条件**:
- 仲間を選んで練習試合可能
- 相手由来アイテムを獲得可能
- 逆侵攻カウント対象外

---

## Epic G: 逆侵攻・奪還

### G-1. 逆侵攻トリガー
**目的**: 侵攻戦5戦ごとに逆侵攻判定。  
**受け入れ条件**:
- 侵攻戦のみカウント
- 5戦到達で判定実行

### G-2. 占領化処理
**目的**: 奪われた県に部下を配置。  
**受け入れ条件**:
- 占領県が専用状態になる
- 県に対応する部下データが割り当てられる

### G-3. 奪還ルール（個別/一括）
**目的**: 2系統の奪還方法を実装。  
**受け入れ条件**:
- 部下撃破で個別奪還
- ボス撃破で配下領地をまとめて奪還

---

## Epic H: 詰み救済（神からの手紙）

### H-1. 奪還チケット実装
**目的**: 激レア救済アイテムを導入。  
**受け入れ条件**:
- チケット所持状態を管理
- 条件範囲内の占領県を即時奪還可能

### H-2. 配布トリガー実装（最終仕様）
**目的**: 会話で合意した配布条件を反映。  
**受け入れ条件**:
- 以下すべて満たしたら配布:
  - 所有領地が残り1県
  - 侵攻戦5連敗
  - 奪還チケット未所持
- 練習試合は連敗カウント外
- 「隣接県が全部勝てない」判定は不要

### H-3. ログインボーナス連携（任意）
**目的**: 5日目配布を将来導入可能に。  
**受け入れ条件**:
- ログボ5日目報酬テーブルにチケットを設定可能
- ON/OFFフラグで無効化できる

---

## Epic I: 東京ラスボス体験

### I-1. 東京ボス難易度設定
**目的**: 最終級として成立させる。  
**受け入れ条件**:
- 全県中トップ難易度帯に配置
- 撃破時の特別演出/報酬導線あり

### I-2. 直行自由ルール
**目的**: ルート自由を担保。  
**受け入れ条件**:
- 到達条件は隣接のみ
- 追加の順序ロックを設けない

---

## Epic J: 保存・検証・運用

### J-1. セーブ/ロード拡張
**目的**: 領土・成長・仲間・逆侵攻状態を保存。  
**受け入れ条件**:
- 中断再開で状態が破綻しない

### J-2. バランス検証ツール
**目的**: 詰み率・勝率をオフライン検証。  
**受け入れ条件**:
- シミュレーション実行で詰み率を計測可能
- 逆侵攻/救済発火回数を確認可能

### J-3. テレメトリ設計（将来）
**目的**: 本番運用で難所を観測。  
**受け入れ条件**:
- 侵攻勝率、逆侵攻発生率、チケット配布率を計測可能

---

## 優先実装順（推奨）
1. A/B/C（モード + マップ + 侵攻戦）
2. G（逆侵攻・奪還）
3. D（難易度分布・部下上限）
4. E/F（成長・スキル・練習）
5. H（詰み救済）
6. I/J（東京演出・検証基盤）

